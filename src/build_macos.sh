
# Auto Generated by:
# "pl_build.py" version: 0.12.0 

################################################################################
#                              Development Setup                               #
################################################################################

# colors
BOLD=$'\e[0;1m'
RED=$'\e[0;31m'
RED_BG=$'\e[0;41m'
GREEN=$'\e[0;32m'
GREEN_BG=$'\e[0;42m'
CYAN=$'\e[0;36m'
MAGENTA=$'\e[0;35m'
YELLOW=$'\e[0;33m'
WHITE=$'\e[0;97m'
NC=$'\e[0m'

# find directory of this script
SOURCE=${BASH_SOURCE[0]}
while [ -h "$SOURCE" ]; do # resolve $SOURCE until the file is no longer a symlink
  DIR=$( cd -P "$( dirname "$SOURCE" )" >/dev/null 2>&1 && pwd )
  SOURCE=$(readlink "$SOURCE")
  [[ $SOURCE != /* ]] && SOURCE=$DIR/$SOURCE # if $SOURCE was a relative symlink, we need to resolve it relative to the path where the symlink file was located
done
DIR=$( cd -P "$( dirname "$SOURCE" )" >/dev/null 2>&1 && pwd )

# get architecture (intel or apple silicon)
ARCH="$(uname -m)"
# make script directory CWD
pushd $DIR >/dev/null

# default configuration
PL_CONFIG=debug

# check command line args for configuration
while getopts ":c:" option; do
   case $option in
   c) # set conf
         PL_CONFIG=$OPTARG;;
     \?) # Invalid option
         echo "Error: Invalid option"
         exit;;
   esac
done

################################################################################
#                            configuration | debug                             #
################################################################################

if [[ "$PL_CONFIG" == "debug" ]]; then

# check if this is a reload
PL_HOT_RELOAD_STATUS=0

# let user know if hot reloading
running_count=$(ps aux | grep -v grep | grep -ci "pilot_light")
if [ $running_count -gt 0 ]
then
PL_HOT_RELOAD_STATUS=1
echo
echo ${BOLD}${WHITE}${RED_BG}--------${GREEN_BG} HOT RELOADING ${RED_BG}--------${NC}
echo
else
# cleanup binaries if not hot reloading
    PL_HOT_RELOAD_STATUS=0
    rm -f ./../out/pilotlight.a
    rm -f ./../out/pl_rect_pack_ext.dylib
    rm -f ./../out/pl_rect_pack_ext_*.dylib
    rm -f ./../out/pl_draw_ext.dylib
    rm -f ./../out/pl_draw_ext_*.dylib
    rm -f ./../out/pl_debug_ext.dylib
    rm -f ./../out/pl_debug_ext_*.dylib
    rm -f ./../out/pl_image_ext.dylib
    rm -f ./../out/pl_image_ext_*.dylib
    rm -f ./../out/pl_stats_ext.dylib
    rm -f ./../out/pl_stats_ext_*.dylib
    rm -f ./../out/pl_job_ext.dylib
    rm -f ./../out/pl_job_ext_*.dylib
    rm -f ./../out/pl_ecs_ext.dylib
    rm -f ./../out/pl_ecs_ext_*.dylib
    rm -f ./../out/pl_model_loader_ext.dylib
    rm -f ./../out/pl_model_loader_ext_*.dylib
    rm -f ./../out/pl_resource_ext.dylib
    rm -f ./../out/pl_resource_ext_*.dylib
    rm -f ./../out/pl_graphics_ext.dylib
    rm -f ./../out/pl_graphics_ext_*.dylib
    rm -f ./../out/pl_gpu_allocators_ext.dylib
    rm -f ./../out/pl_gpu_allocators_ext_*.dylib
    rm -f ./../out/pl_ref_renderer_ext.dylib
    rm -f ./../out/pl_ref_renderer_ext_*.dylib
    rm -f ./../out/pl_ui_ext.dylib
    rm -f ./../out/pl_ui_ext_*.dylib
    rm -f ./../out/pl_shader_ext.dylib
    rm -f ./../out/pl_shader_ext_*.dylib
    rm -f ./../out/pl_script_camera.dylib
    rm -f ./../out/pl_script_camera_*.dylib
    rm -f ./../out/editor.dylib
    rm -f ./../out/editor_*.dylib
    rm -f ./../out/app.dylib
    rm -f ./../out/app_*.dylib
    rm -f ./../out/pilot_light
fi

################################################################################
#                            debug | pilotlight_lib                            #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-DPL_METAL_BACKEND -D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# run compiler only
echo
echo ${YELLOW}Step: pilotlight_lib${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling...${NC}

# each file must be compiled separately
clang -c -fPIC $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS pilotlight_lib.c -o "./../out/pilotlight_lib.o"

# combine object files into a static lib
ar rcs ./../out/pilotlight.a ./../out/*.o
rm ./../out/*.o

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                           debug | pl_rect_pack_ext                           #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_rect_pack_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_rect_pack_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_rect_pack_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                             debug | pl_draw_ext                              #
################################################################################

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_draw_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_draw_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_draw_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

################################################################################
#                             debug | pl_debug_ext                             #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_debug_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_debug_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_debug_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                             debug | pl_image_ext                             #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_image_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_image_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_image_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                             debug | pl_stats_ext                             #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_stats_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_stats_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_stats_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                              debug | pl_job_ext                              #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_job_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_job_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_job_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                              debug | pl_ecs_ext                              #
################################################################################

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_ecs_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_ecs_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_ecs_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

################################################################################
#                         debug | pl_model_loader_ext                          #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_model_loader_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_model_loader_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_model_loader_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                           debug | pl_resource_ext                            #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_resource_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_resource_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_resource_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                          debug | pl_graphics_metal                           #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_graphics_metal.m ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_graphics_metal${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_graphics_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                        debug | pl_gpu_allocators_ext                         #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_gpu_allocators_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_gpu_allocators_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_gpu_allocators_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                         debug | pl_ref_renderer_ext                          #
################################################################################

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_ref_renderer_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_ref_renderer_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_ref_renderer_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

################################################################################
#                              debug | pl_ui_ext                               #
################################################################################

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_ui_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_ui_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_ui_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

################################################################################
#                            debug | pl_shader_ext                             #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES="-l spirv-cross-c-shared -l shaderc_shared "

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_shader_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_shader_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_shader_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                           debug | pl_script_camera                           #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_METAL_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_script_camera.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_script_camera${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_script_camera.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                                debug | editor                                #
################################################################################

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-DPL_METAL_BACKEND -D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../editor/editor.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: editor${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/editor.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

################################################################################
#                                 debug | app                                  #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-DPL_METAL_BACKEND -D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../editor/app.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: app${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/app.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                             debug | pilot_light                              #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-DPL_METAL_BACKEND -D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="pl_main_macos.m "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pilot_light${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES -o "./../out/pilot_light"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# end of debug 
fi
################################################################################
#                            configuration | vulkan                            #
################################################################################

if [[ "$PL_CONFIG" == "vulkan" ]]; then

# check if this is a reload
PL_HOT_RELOAD_STATUS=0

# let user know if hot reloading
running_count=$(ps aux | grep -v grep | grep -ci "pilot_light")
if [ $running_count -gt 0 ]
then
PL_HOT_RELOAD_STATUS=1
echo
echo ${BOLD}${WHITE}${RED_BG}--------${GREEN_BG} HOT RELOADING ${RED_BG}--------${NC}
echo
else
# cleanup binaries if not hot reloading
    PL_HOT_RELOAD_STATUS=0
    rm -f ./../out/pilotlight.a
    rm -f ./../out/pl_rect_pack_ext.dylib
    rm -f ./../out/pl_rect_pack_ext_*.dylib
    rm -f ./../out/pl_draw_ext.dylib
    rm -f ./../out/pl_draw_ext_*.dylib
    rm -f ./../out/pl_debug_ext.dylib
    rm -f ./../out/pl_debug_ext_*.dylib
    rm -f ./../out/pl_image_ext.dylib
    rm -f ./../out/pl_image_ext_*.dylib
    rm -f ./../out/pl_stats_ext.dylib
    rm -f ./../out/pl_stats_ext_*.dylib
    rm -f ./../out/pl_job_ext.dylib
    rm -f ./../out/pl_job_ext_*.dylib
    rm -f ./../out/pl_model_loader_ext.dylib
    rm -f ./../out/pl_model_loader_ext_*.dylib
    rm -f ./../out/pl_ecs_ext.dylib
    rm -f ./../out/pl_ecs_ext_*.dylib
    rm -f ./../out/pl_resource_ext.dylib
    rm -f ./../out/pl_resource_ext_*.dylib
    rm -f ./../out/pl_gpu_allocators_ext.dylib
    rm -f ./../out/pl_gpu_allocators_ext_*.dylib
    rm -f ./../out/pl_ui_ext.dylib
    rm -f ./../out/pl_ui_ext_*.dylib
    rm -f ./../out/pl_ref_renderer_ext.dylib
    rm -f ./../out/pl_ref_renderer_ext_*.dylib
    rm -f ./../out/pl_graphics_ext.dylib
    rm -f ./../out/pl_graphics_ext_*.dylib
    rm -f ./../out/pl_shader_ext.dylib
    rm -f ./../out/pl_shader_ext_*.dylib
    rm -f ./../out/pl_script_camera.dylib
    rm -f ./../out/pl_script_camera_*.dylib
    rm -f ./../out/editor.dylib
    rm -f ./../out/editor_*.dylib
    rm -f ./../out/pilot_light
fi

################################################################################
#                           vulkan | pilotlight_lib                            #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-DPL_VULKAN_BACKEND -D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# run compiler only
echo
echo ${YELLOW}Step: pilotlight_lib${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling...${NC}

# each file must be compiled separately
clang -c -fPIC $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS pilotlight_lib.c -o "./../out/pilotlight_lib.o"

# combine object files into a static lib
ar rcs ./../out/pilotlight.a ./../out/*.o
rm ./../out/*.o

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                          vulkan | pl_rect_pack_ext                           #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_rect_pack_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_rect_pack_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_rect_pack_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                             vulkan | pl_draw_ext                             #
################################################################################

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_draw_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_draw_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_draw_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

################################################################################
#                            vulkan | pl_debug_ext                             #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_debug_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_debug_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_debug_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                            vulkan | pl_image_ext                             #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_image_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_image_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_image_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                            vulkan | pl_stats_ext                             #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_stats_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_stats_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_stats_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                             vulkan | pl_job_ext                              #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_job_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_job_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_job_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                         vulkan | pl_model_loader_ext                         #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_model_loader_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_model_loader_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_model_loader_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                             vulkan | pl_ecs_ext                              #
################################################################################

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_ecs_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_ecs_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_ecs_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

################################################################################
#                           vulkan | pl_resource_ext                           #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_resource_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_resource_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_resource_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                        vulkan | pl_gpu_allocators_ext                        #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_gpu_allocators_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_gpu_allocators_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_gpu_allocators_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                              vulkan | pl_ui_ext                              #
################################################################################

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_ui_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_ui_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_ui_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

################################################################################
#                         vulkan | pl_ref_renderer_ext                         #
################################################################################

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_VULKAN_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES="-l vulkan "

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_ref_renderer_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_ref_renderer_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_ref_renderer_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

################################################################################
#                         vulkan | pl_graphics_vulkan                          #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_VULKAN_BACKEND "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES="-l vulkan "

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_graphics_vulkan.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_graphics_vulkan${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_graphics_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                            vulkan | pl_shader_ext                            #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES="-l shaderc_shared -l vulkan "

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_shader_ext.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_shader_ext${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_shader_ext.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                          vulkan | pl_script_camera                           #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES=""

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../extensions/pl_script_camera.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pl_script_camera${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/pl_script_camera.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

################################################################################
#                               vulkan | editor                                #
################################################################################

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-DPL_VULKAN_BACKEND -D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES="-l vulkan "

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="../editor/editor.c ../out/pilotlight.a "

# run compiler (and linker)
echo
echo ${YELLOW}Step: editor${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -shared -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES $PL_LINK_FRAMEWORKS -o "./../out/editor.dylib"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

################################################################################
#                             vulkan | pilot_light                             #
################################################################################

# skip during hot reload
 if [ $PL_HOT_RELOAD_STATUS -ne 1 ]; then 

# create output directory
if ! [[ -d "../out" ]]; then
    mkdir "../out"
fi

# create lock file
echo LOCKING > "./../out/lock.tmp"

# preprocessor defines
PL_DEFINES="-DPL_VULKAN_BACKEND -D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS "

# includes directories
PL_INCLUDE_DIRECTORIES="-I../editor -I../src -I../libs -I../extensions -I../out -I../dependencies/stb -I../dependencies/cgltf "

# link directories
PL_LINK_DIRECTORIES="-L../out "

# compiler flags
PL_COMPILER_FLAGS="-std=c99 --debug -g -fmodules -ObjC "

# add flags for specific hardware
if [[ "$ARCH" == "arm64" ]]; then
    PL_COMPILER_FLAGS+="-arch arm64 "
else
    PL_COMPILER_FLAGS+="-arch x86_64 "
fi

# linker flags
PL_LINKER_FLAGS="-Wl,-rpath,/usr/local/lib "

# libraries
PL_LINK_LIBRARIES="-l vulkan "

# frameworks
PL_LINK_FRAMEWORKS="-framework Metal -framework MetalKit -framework Cocoa -framework IOKit -framework CoreVideo -framework QuartzCore "

# default compilation result
PL_RESULT=${BOLD}${GREEN}Successful.${NC}

# source files
PL_SOURCES="pl_main_macos.m "

# run compiler (and linker)
echo
echo ${YELLOW}Step: pilot_light${NC}
echo ${YELLOW}~~~~~~~~~~~~~~~~~~~${NC}
echo ${CYAN}Compiling and Linking...${NC}
clang -fPIC $PL_SOURCES $PL_INCLUDE_DIRECTORIES $PL_DEFINES $PL_COMPILER_FLAGS $PL_INCLUDE_DIRECTORIES $PL_LINK_DIRECTORIES $PL_LINKER_FLAGS $PL_LINK_LIBRARIES -o "./../out/pilot_light"

# check build status
if [ $? -ne 0 ]
then
    PL_RESULT=${BOLD}${RED}Failed.${NC}
fi

# print results
echo ${CYAN}Results: ${NC} ${PL_RESULT}
echo ${CYAN}~~~~~~~~~~~~~~~~~~~~~~${NC}

# remove lock file
rm "./../out/lock.tmp"

fi

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# end of vulkan 
fi
# return CWD to previous CWD
popd >/dev/null