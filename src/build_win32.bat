
@rem Auto Generated by:
@rem "pl_build.py" version: 0.12.0 

@rem ################################################################################
@rem #                              Development Setup                               #
@rem ################################################################################

@rem keep environment variables modifications local
@setlocal

@rem make script directory CWD
@pushd %~dp0
@set dir=%~dp0

@rem modify PATH to find vcvarsall.bat
@set PATH=C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Auxiliary\Build;%PATH%
@set PATH=C:\Program Files\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build;%PATH%
@set PATH=C:\Program Files (x86)\Microsoft Visual Studio\2022\Community\VC\Auxiliary\Build;%PATH%
@set PATH=C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build;%PATH%
@set PATH=C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise/VC\Auxiliary\Build;%PATH%

@rem setup environment for MSVC dev tools
@call vcvarsall.bat amd64 > nul

@rem default compilation result
@set PL_RESULT=[1m[92mSuccessful.[0m

@rem default configuration
@set PL_CONFIG=debug

@rem check command line args for configuration
:CheckConfiguration
@if "%~1"=="-c" (@set PL_CONFIG=%2) & @shift & @shift & @goto CheckConfiguration
@if "%PL_CONFIG%" equ "debug" ( goto debug )
@if "%PL_CONFIG%" equ "vulkan" ( goto vulkan )

@rem ################################################################################
@rem #                            configuration | debug                             #
@rem ################################################################################

:debug

@rem create main target output directoy
@if not exist "../out" @mkdir "../out"

@rem check if this is a reload
@set PL_HOT_RELOAD_STATUS=0

@rem hack to see if main exe is running
@echo off
2>nul (>>"../out/pilot_light.exe" echo off) && (@set PL_HOT_RELOAD_STATUS=0) || (@set PL_HOT_RELOAD_STATUS=1)

@rem let user know if hot reloading
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    @echo.
    @echo [1m[97m[41m--------[42m HOT RELOADING [41m--------[0m
)

@rem cleanup binaries if not hot reloading
@if %PL_HOT_RELOAD_STATUS% equ 0 (
    @echo.
    @if exist "../out/pilotlight.lib" del "../out/pilotlight.lib"
    @if exist "../out/pl_rect_pack_ext.dll" del "../out/pl_rect_pack_ext.dll"
    @if exist "../out/pl_rect_pack_ext_*.dll" del "../out/pl_rect_pack_ext_*.dll"
    @if exist "../out/pl_rect_pack_ext_*.pdb" del "../out/pl_rect_pack_ext_*.pdb"
    @if exist "../out/pl_draw_ext.dll" del "../out/pl_draw_ext.dll"
    @if exist "../out/pl_draw_ext_*.dll" del "../out/pl_draw_ext_*.dll"
    @if exist "../out/pl_draw_ext_*.pdb" del "../out/pl_draw_ext_*.pdb"
    @if exist "../out/pl_debug_ext.dll" del "../out/pl_debug_ext.dll"
    @if exist "../out/pl_debug_ext_*.dll" del "../out/pl_debug_ext_*.dll"
    @if exist "../out/pl_debug_ext_*.pdb" del "../out/pl_debug_ext_*.pdb"
    @if exist "../out/pl_image_ext.dll" del "../out/pl_image_ext.dll"
    @if exist "../out/pl_image_ext_*.dll" del "../out/pl_image_ext_*.dll"
    @if exist "../out/pl_image_ext_*.pdb" del "../out/pl_image_ext_*.pdb"
    @if exist "../out/pl_stats_ext.dll" del "../out/pl_stats_ext.dll"
    @if exist "../out/pl_stats_ext_*.dll" del "../out/pl_stats_ext_*.dll"
    @if exist "../out/pl_stats_ext_*.pdb" del "../out/pl_stats_ext_*.pdb"
    @if exist "../out/pl_job_ext.dll" del "../out/pl_job_ext.dll"
    @if exist "../out/pl_job_ext_*.dll" del "../out/pl_job_ext_*.dll"
    @if exist "../out/pl_job_ext_*.pdb" del "../out/pl_job_ext_*.pdb"
    @if exist "../out/pl_model_loader_ext.dll" del "../out/pl_model_loader_ext.dll"
    @if exist "../out/pl_model_loader_ext_*.dll" del "../out/pl_model_loader_ext_*.dll"
    @if exist "../out/pl_model_loader_ext_*.pdb" del "../out/pl_model_loader_ext_*.pdb"
    @if exist "../out/pl_ecs_ext.dll" del "../out/pl_ecs_ext.dll"
    @if exist "../out/pl_ecs_ext_*.dll" del "../out/pl_ecs_ext_*.dll"
    @if exist "../out/pl_ecs_ext_*.pdb" del "../out/pl_ecs_ext_*.pdb"
    @if exist "../out/pl_resource_ext.dll" del "../out/pl_resource_ext.dll"
    @if exist "../out/pl_resource_ext_*.dll" del "../out/pl_resource_ext_*.dll"
    @if exist "../out/pl_resource_ext_*.pdb" del "../out/pl_resource_ext_*.pdb"
    @if exist "../out/pl_gpu_allocators_ext.dll" del "../out/pl_gpu_allocators_ext.dll"
    @if exist "../out/pl_gpu_allocators_ext_*.dll" del "../out/pl_gpu_allocators_ext_*.dll"
    @if exist "../out/pl_gpu_allocators_ext_*.pdb" del "../out/pl_gpu_allocators_ext_*.pdb"
    @if exist "../out/pl_ui_ext.dll" del "../out/pl_ui_ext.dll"
    @if exist "../out/pl_ui_ext_*.dll" del "../out/pl_ui_ext_*.dll"
    @if exist "../out/pl_ui_ext_*.pdb" del "../out/pl_ui_ext_*.pdb"
    @if exist "../out/pl_ref_renderer_ext.dll" del "../out/pl_ref_renderer_ext.dll"
    @if exist "../out/pl_ref_renderer_ext_*.dll" del "../out/pl_ref_renderer_ext_*.dll"
    @if exist "../out/pl_ref_renderer_ext_*.pdb" del "../out/pl_ref_renderer_ext_*.pdb"
    @if exist "../out/pl_graphics_ext.dll" del "../out/pl_graphics_ext.dll"
    @if exist "../out/pl_graphics_ext_*.dll" del "../out/pl_graphics_ext_*.dll"
    @if exist "../out/pl_graphics_ext_*.pdb" del "../out/pl_graphics_ext_*.pdb"
    @if exist "../out/pl_shader_ext.dll" del "../out/pl_shader_ext.dll"
    @if exist "../out/pl_shader_ext_*.dll" del "../out/pl_shader_ext_*.dll"
    @if exist "../out/pl_shader_ext_*.pdb" del "../out/pl_shader_ext_*.pdb"
    @if exist "../out/pl_script_camera.dll" del "../out/pl_script_camera.dll"
    @if exist "../out/pl_script_camera_*.dll" del "../out/pl_script_camera_*.dll"
    @if exist "../out/pl_script_camera_*.pdb" del "../out/pl_script_camera_*.pdb"
    @if exist "../out/editor.dll" del "../out/editor.dll"
    @if exist "../out/editor_*.dll" del "../out/editor_*.dll"
    @if exist "../out/editor_*.pdb" del "../out/editor_*.pdb"
    @if exist "../out/app.dll" del "../out/app.dll"
    @if exist "../out/app_*.dll" del "../out/app_*.dll"
    @if exist "../out/app_*.pdb" del "../out/app_*.pdb"
    @if exist "../out/pilot_light.exe" del "../out/pilot_light.exe"
    @if exist "../out/pilot_light_*.pdb" del "../out/pilot_light_*.pdb"
)

@rem ################################################################################
@rem #                            debug | pilotlight_lib                            #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_pilotlight_lib
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-DPL_VULKAN_BACKEND -D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" -I"%VULKAN_SDK%\Include" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" -LIBPATH:"%VULKAN_SDK%\Lib" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-nodefaultlib:MSVCRT -incremental:no 

@rem libraries to link to
@set PL_LINK_LIBRARIES=vulkan-1.lib 
@rem run compiler only
@echo.
@echo [1m[93mStep: pilotlight_lib[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling...[0m

@rem each file must be compiled separately
cl -c %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% pilotlight_lib.c -Fo"../out/"

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem if failed, skip linking
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppilotlight_lib
)

@rem link object files into a shared lib
@echo [1m[36mLinking...[0m
lib -nologo -OUT:"../out/pilotlight.lib" "../out/*.obj"

@rem cleanup obj files
:Cleanuppilotlight_lib
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_pilotlight_lib

@rem ################################################################################
@rem #                           debug | pl_rect_pack_ext                           #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_pl_rect_pack_ext
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_rect_pack_ext.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_rect_pack_ext[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_rect_pack_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_rect_pack_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_rect_pack_ext
)

@rem cleanup obj files
:Cleanuppl_rect_pack_ext
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_pl_rect_pack_ext

@rem ################################################################################
@rem #                             debug | pl_draw_ext                              #
@rem ################################################################################

@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_draw_ext.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_draw_ext[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_draw_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_draw_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_draw_ext
)

@rem cleanup obj files
:Cleanuppl_draw_ext
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

@rem ################################################################################
@rem #                             debug | pl_debug_ext                             #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_pl_debug_ext
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_debug_ext.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_debug_ext[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_debug_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_debug_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_debug_ext
)

@rem cleanup obj files
:Cleanuppl_debug_ext
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_pl_debug_ext

@rem ################################################################################
@rem #                             debug | pl_image_ext                             #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_pl_image_ext
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_image_ext.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_image_ext[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_image_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_image_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_image_ext
)

@rem cleanup obj files
:Cleanuppl_image_ext
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_pl_image_ext

@rem ################################################################################
@rem #                             debug | pl_stats_ext                             #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_pl_stats_ext
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_stats_ext.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_stats_ext[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_stats_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_stats_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_stats_ext
)

@rem cleanup obj files
:Cleanuppl_stats_ext
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_pl_stats_ext

@rem ################################################################################
@rem #                              debug | pl_job_ext                              #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_pl_job_ext
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_job_ext.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_job_ext[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_job_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_job_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_job_ext
)

@rem cleanup obj files
:Cleanuppl_job_ext
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_pl_job_ext

@rem ################################################################################
@rem #                         debug | pl_model_loader_ext                          #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_pl_model_loader_ext
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_model_loader_ext.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_model_loader_ext[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_model_loader_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_model_loader_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_model_loader_ext
)

@rem cleanup obj files
:Cleanuppl_model_loader_ext
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_pl_model_loader_ext

@rem ################################################################################
@rem #                              debug | pl_ecs_ext                              #
@rem ################################################################################

@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_ecs_ext.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_ecs_ext[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_ecs_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_ecs_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_ecs_ext
)

@rem cleanup obj files
:Cleanuppl_ecs_ext
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

@rem ################################################################################
@rem #                           debug | pl_resource_ext                            #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_pl_resource_ext
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_resource_ext.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_resource_ext[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_resource_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_resource_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_resource_ext
)

@rem cleanup obj files
:Cleanuppl_resource_ext
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_pl_resource_ext

@rem ################################################################################
@rem #                        debug | pl_gpu_allocators_ext                         #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_pl_gpu_allocators_ext
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_gpu_allocators_ext.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_gpu_allocators_ext[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_gpu_allocators_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_gpu_allocators_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_gpu_allocators_ext
)

@rem cleanup obj files
:Cleanuppl_gpu_allocators_ext
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_pl_gpu_allocators_ext

@rem ################################################################################
@rem #                              debug | pl_ui_ext                               #
@rem ################################################################################

@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_ui_ext.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_ui_ext[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_ui_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_ui_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_ui_ext
)

@rem cleanup obj files
:Cleanuppl_ui_ext
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

@rem ################################################################################
@rem #                         debug | pl_ref_renderer_ext                          #
@rem ################################################################################

@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_VULKAN_BACKEND -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" -I"%VULKAN_SDK%\Include" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" -LIBPATH:"%VULKAN_SDK%\Lib" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-nodefaultlib:MSVCRT -incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=vulkan-1.lib pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_ref_renderer_ext.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_ref_renderer_ext[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_ref_renderer_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_ref_renderer_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_ref_renderer_ext
)

@rem cleanup obj files
:Cleanuppl_ref_renderer_ext
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

@rem ################################################################################
@rem #                          debug | pl_graphics_vulkan                          #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_pl_graphics_vulkan
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -DPL_VULKAN_BACKEND -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" -I"%VULKAN_SDK%\Include" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" -LIBPATH:"%VULKAN_SDK%\Lib" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-nodefaultlib:MSVCRT -incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=vulkan-1.lib pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_graphics_vulkan.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_graphics_vulkan[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_graphics_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_graphics_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_graphics_vulkan
)

@rem cleanup obj files
:Cleanuppl_graphics_vulkan
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_pl_graphics_vulkan

@rem ################################################################################
@rem #                           debug | pl_rect_pack_ext                           #
@rem ################################################################################

@rem ################################################################################
@rem #                             debug | pl_draw_ext                              #
@rem ################################################################################

@rem ################################################################################
@rem #                             debug | pl_debug_ext                             #
@rem ################################################################################

@rem ################################################################################
@rem #                             debug | pl_image_ext                             #
@rem ################################################################################

@rem ################################################################################
@rem #                             debug | pl_stats_ext                             #
@rem ################################################################################

@rem ################################################################################
@rem #                              debug | pl_job_ext                              #
@rem ################################################################################

@rem ################################################################################
@rem #                              debug | pl_ecs_ext                              #
@rem ################################################################################

@rem ################################################################################
@rem #                         debug | pl_model_loader_ext                          #
@rem ################################################################################

@rem ################################################################################
@rem #                           debug | pl_resource_ext                            #
@rem ################################################################################

@rem ################################################################################
@rem #                          debug | pl_graphics_metal                           #
@rem ################################################################################

@rem ################################################################################
@rem #                        debug | pl_gpu_allocators_ext                         #
@rem ################################################################################

@rem ################################################################################
@rem #                         debug | pl_ref_renderer_ext                          #
@rem ################################################################################

@rem ################################################################################
@rem #                              debug | pl_ui_ext                               #
@rem ################################################################################

@rem ################################################################################
@rem #                            debug | pl_shader_ext                             #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_pl_shader_ext
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" -I"%VULKAN_SDK%\Include" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" -LIBPATH:"%VULKAN_SDK%\Lib" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-nodefaultlib:MSVCRT -incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=shaderc_combined.lib vulkan-1.lib pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_shader_ext.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_shader_ext[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_shader_ext.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_shader_ext_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_shader_ext
)

@rem cleanup obj files
:Cleanuppl_shader_ext
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_pl_shader_ext

@rem ################################################################################
@rem #                            debug | pl_shader_ext                             #
@rem ################################################################################

@rem ################################################################################
@rem #                           debug | pl_script_camera                           #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_pl_script_camera
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=pilotlight.lib 

@rem source files
@set PL_SOURCES="../extensions/pl_script_camera.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pl_script_camera[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pl_script_camera.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/pl_script_camera_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppl_script_camera
)

@rem cleanup obj files
:Cleanuppl_script_camera
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_pl_script_camera

@rem ################################################################################
@rem #                           debug | pl_script_camera                           #
@rem ################################################################################

@rem ################################################################################
@rem #                                debug | editor                                #
@rem ################################################################################

@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-DPL_VULKAN_BACKEND -D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" -I"%VULKAN_SDK%\Include" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" -LIBPATH:"%VULKAN_SDK%\Lib" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-nodefaultlib:MSVCRT -incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=vulkan-1.lib pilotlight.lib 

@rem source files
@set PL_SOURCES="../editor/editor.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: editor[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/editor.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/editor_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanupeditor
)

@rem cleanup obj files
:Cleanupeditor
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

@rem ################################################################################
@rem #                                 debug | app                                  #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_app
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-DPL_VULKAN_BACKEND -D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" -I"%VULKAN_SDK%\Include" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" -LIBPATH:"%VULKAN_SDK%\Lib" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-nodefaultlib:MSVCRT -incremental:no -noimplib -noexp 

@rem libraries to link to
@set PL_LINK_LIBRARIES=vulkan-1.lib pilotlight.lib 

@rem source files
@set PL_SOURCES="../editor/app.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: app[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/app.dll" -Fo"../out/" -LD -link %PL_LINKER_FLAGS% -PDB:"../out/app_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanupapp
)

@rem cleanup obj files
:Cleanupapp
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_app

@rem ################################################################################
@rem #                             debug | pilot_light                              #
@rem ################################################################################

@rem skip during hot reload
@if %PL_HOT_RELOAD_STATUS% equ 1 (
    goto Exit_pilot_light
)
@rem create output directory
@if not exist "../out" @mkdir "../out"

@rem create lock file
@echo LOCKING > "../out/lock.tmp"

@rem preprocessor defines
@set PL_DEFINES=-DPL_VULKAN_BACKEND -D_DEBUG -D_USE_MATH_DEFINES -DPL_PROFILING_ON -DPL_ALLOW_HOT_RELOAD -DPL_ENABLE_VALIDATION_LAYERS -D_DEBUG 

@rem include directories
@set PL_INCLUDE_DIRECTORIES=-I"../editor" -I"../src" -I"../libs" -I"../extensions" -I"../out" -I"../dependencies/stb" -I"../dependencies/cgltf" -I"%WindowsSdkDir%Include\um" -I"%WindowsSdkDir%Include\shared" -I"%VULKAN_SDK%\Include" 

@rem link directories
@set PL_LINK_DIRECTORIES=-LIBPATH:"../out" -LIBPATH:"%VULKAN_SDK%\Lib" 

@rem compiler flags
@set PL_COMPILER_FLAGS=-Zc:preprocessor -nologo -std:c11 -W4 -WX -wd4201 -wd4100 -wd4996 -wd4505 -wd4189 -wd5105 -wd4115 -permissive- -Od -MDd -Zi 

@rem linker flags
@set PL_LINKER_FLAGS=-nodefaultlib:MSVCRT -incremental:no 

@rem libraries to link to
@set PL_LINK_LIBRARIES=vulkan-1.lib 

@rem source files
@set PL_SOURCES="pl_main_win32.c" 

@rem run compiler (and linker)
@echo.
@echo [1m[93mStep: pilot_light[0m
@echo [1m[93m~~~~~~~~~~~~~~~~~~~~~~[0m
@echo [1m[36mCompiling and Linking...[0m

@rem skip actual compilation if hot reloading
@if %PL_HOT_RELOAD_STATUS% equ 1 ( goto Cleanuppilot_light )

@rem call compiler
cl %PL_INCLUDE_DIRECTORIES% %PL_DEFINES% %PL_COMPILER_FLAGS% %PL_SOURCES% -Fe"../out/pilot_light.exe" -Fo"../out/" -link %PL_LINKER_FLAGS% -PDB:"../out/pilot_light_%random%.pdb" %PL_LINK_DIRECTORIES% %PL_LINK_LIBRARIES%

@rem check build status
@set PL_BUILD_STATUS=%ERRORLEVEL%

@rem failed
@if %PL_BUILD_STATUS% NEQ 0 (
    @echo [1m[91mCompilation Failed with error code[0m: %PL_BUILD_STATUS%
    @set PL_RESULT=[1m[91mFailed.[0m
    goto Cleanuppilot_light
)

@rem cleanup obj files
:Cleanuppilot_light
    @echo [1m[36mCleaning...[0m
    @del "../out/*.obj"  > nul 2> nul
@rem delete lock file
@del "../out/lock.tmp"

@rem print results
@echo.
@echo [36mResult: [0m %PL_RESULT%
@echo [36m~~~~~~~~~~~~~~~~~~~~~~[0m

:Exit_pilot_light

@rem ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@rem end of debug configuration
goto ExitLabel



@rem ################################################################################
@rem #                           vulkan | pilotlight_lib                            #
@rem ################################################################################

@rem ################################################################################
@rem #                          vulkan | pl_rect_pack_ext                           #
@rem ################################################################################

@rem ################################################################################
@rem #                             vulkan | pl_draw_ext                             #
@rem ################################################################################

@rem ################################################################################
@rem #                            vulkan | pl_debug_ext                             #
@rem ################################################################################

@rem ################################################################################
@rem #                            vulkan | pl_image_ext                             #
@rem ################################################################################

@rem ################################################################################
@rem #                            vulkan | pl_stats_ext                             #
@rem ################################################################################

@rem ################################################################################
@rem #                             vulkan | pl_job_ext                              #
@rem ################################################################################

@rem ################################################################################
@rem #                         vulkan | pl_model_loader_ext                         #
@rem ################################################################################

@rem ################################################################################
@rem #                             vulkan | pl_ecs_ext                              #
@rem ################################################################################

@rem ################################################################################
@rem #                           vulkan | pl_resource_ext                           #
@rem ################################################################################

@rem ################################################################################
@rem #                        vulkan | pl_gpu_allocators_ext                        #
@rem ################################################################################

@rem ################################################################################
@rem #                              vulkan | pl_ui_ext                              #
@rem ################################################################################

@rem ################################################################################
@rem #                         vulkan | pl_ref_renderer_ext                         #
@rem ################################################################################

@rem ################################################################################
@rem #                         vulkan | pl_graphics_vulkan                          #
@rem ################################################################################

@rem ################################################################################
@rem #                            vulkan | pl_shader_ext                            #
@rem ################################################################################

@rem ################################################################################
@rem #                          vulkan | pl_script_camera                           #
@rem ################################################################################

@rem ################################################################################
@rem #                               vulkan | editor                                #
@rem ################################################################################

@rem ################################################################################
@rem #                             vulkan | pilot_light                             #
@rem ################################################################################

:ExitLabel
@rem return CWD to previous CWD
@popd